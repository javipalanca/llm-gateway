# ============================================
# LLM Gateway - Environment Variables
# ============================================
# Copy this file as .env and adjust the values

# ============================================
# PostgreSQL Database
# ============================================
POSTGRES_USER=gateway
POSTGRES_PASSWORD=CHANGE_ME_STRONG_PASSWORD
POSTGRES_DB=gateway

# ============================================
# Controller Configuration
# ============================================
# IP address of the host where services run
# This IP must be accessible from within containers
VLLM_HOST_IP=127.0.0.1

# PostgreSQL database URL
# Format: postgresql://user:password@host:port/database
DATABASE_URL=postgresql://${POSTGRES_USER}:${POSTGRES_PASSWORD}@postgres:5432/${POSTGRES_DB}

# Idle time (minutes) before stopping a model
IDLE_TTL_MINUTES=20

# Path to the model configuration file
MODELS_CONFIG=/app/models.yaml

# Timeout (seconds) to wait for a model to be ready
MODEL_READY_TIMEOUT_SEC=300

# Time interval (seconds) between readiness polling
MODEL_READY_POLL_SEC=1

# ============================================
# VRAM Pre-check Configuration
# ============================================
# CUDA image to run nvidia-smi
CUDA_SMI_IMAGE=nvidia/cuda:12.4.1-base-ubuntu22.04

# Maximum number of eviction attempts before giving up
EVICT_RETRY_LIMIT=4

# Eviction attempts after failed model startup
EVICT_AFTER_FAILED_START=1

# ============================================
# Network Configuration
# ============================================
# External port for Controller (orchestrator)
CONTROLLER_EXTERNAL_PORT=9010

# ============================================
# Volumes & Paths
# ============================================
# Path on the host where downloaded models are stored
MODELS_PATH=/models

# ============================================
# Observability - Prometheus & Grafana
# ============================================
# Port for Prometheus (metrics)
PROMETHEUS_PORT=9090

# Port for Grafana (dashboards)
GRAFANA_PORT=3000

# Grafana admin user
GRAFANA_ADMIN_USER=admin

# Grafana admin password
# IMPORTANT: Change this value in production
GRAFANA_ADMIN_PASSWORD=CHANGE_ME_GRAFANA_PASSWORD

# Allow new user registration (true/false)
GRAFANA_ALLOW_SIGNUP=false

# Grafana root URL (adjust according to your domain/IP)
GRAFANA_ROOT_URL=http://127.0.0.1:3000
GRAFANA_SERVER_DOMAIN=127.0.0.1

# ============================================
# Public Dashboard Settings
# ============================================
# Enable public dashboards (read-only access without login)
# Requires: GF_SECURITY_PUBLIC_DASHBOARDS_ENABLED in docker-compose.yml
# After enabling, run: ./make_dashboard_public.sh to expose dashboard
GF_SECURITY_PUBLIC_DASHBOARDS_ENABLED=true

# Allow dashboards to be embedded in iframes
GF_SECURITY_ALLOW_EMBEDDING=true

# ============================================
# Metrics Persistence
# ============================================
# Days to retain metrics snapshots in PostgreSQL
METRICS_RETENTION_DAYS=30

# ============================================
# HuggingFace Configuration
# ============================================
# HuggingFace access token (for private models or large downloads)
HF_TOKEN=your_token